<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="utf-8">
    <title>乐育谷云平台</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="<?php echo arCfg('PATH.PUBLIC'); ?>css/zaojiao.css">
    <!--[if IE 8]> <link href='/Themes/Theme3/ie8Fix.css' rel='stylesheet' /> <![endif]-->
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jquery-1.4.2.min.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/flexigrid.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jQuery.Ex.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jQuery.etmTabs.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jQuery.etmLinks.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jquery.placeholder.min.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/uploadify/jquery.uploadify.min.js" type="text/javascript"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/json2.min.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jquery.cookie.js"></script>
    <script src="<?php echo arCfg('PATH.PUBLIC'); ?>/js/jquery.nicescroll.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var isEtmClient = false;

        function ReSizeScrollbar() {
            if ($('form').getNiceScroll().length > 0) {
                $('form').getNiceScroll().onResize();
            }
        }

        function ReSizeFlexgridScrollbar() {
            if ($('.bDiv').getNiceScroll().length > 0) {
                $('.bDiv').getNiceScroll().onResize();
            }
        }

        function InitFlexgridScrollbar() {
            $('.bDiv').niceScroll({
                cursorcolor: '#75A801',
                zindex: 4
            });
        }

        function ReSizenDivScrollbar() {
            if ($('.flexigrid .nDiv').getNiceScroll().length > 0) {
                $('.flexigrid .nDiv').getNiceScroll().onResize();
            }
        }

        function InitnDivScrollbar() {
            $('.flexigrid .nDiv').niceScroll({
                cursorcolor: '#75A801',
                horizrailenabled: false
            });
        }

        function proxyExecuteFun(funName) {
            if (funName == undefined || funName == null || funName.length == 0) {
                window.parent.showsending(true, "执行中，请耐心等待...");
                return;
            }
            if (window[funName]()) {
                window.parent.showsending(true, "执行中，请耐心等待...");
                return true;
            }
            return false;
        };
        var _tmpOnSelectedFile = null;

        function onSelectedFile(fileName, fileUrl, isImg) {
            if (_tmpOnSelectedFile != null) {
                _tmpOnSelectedFile(fileName, fileUrl, isImg);
            }
        }

        function showFileList(callback) {
            window.parent.showDialog('查看素材库', '/Modules/OA/CMyFileListView.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4', '900px', '450px');
            _tmpOnSelectedFile = callback;
        }
        $(function() {
            if (window.parent != undefined && window.parent != null && typeof window.parent.showsending != "undefined") {
                window.parent.showsending(false, '');
            }
            $(".button").each(function() {
                if ($(this).attr("type") == "submit" && !$(this).hasClass('noloading') && window.parent != undefined && window.parent != null && typeof window.parent.showsending != "undefined") {
                    var tmpClick = $(this).attr("onclick");
                    if (tmpClick == undefined || tmpClick == null || tmpClick.length < 2) {
                        $(this).attr("onclick", "proxyExecuteFun();");
                        return;
                    }
                    if (tmpClick.indexOf("return ") != -1 && tmpClick.indexOf("(") != -1) {
                        tmpClick = tmpClick.substring(7).replace(/\s+/g, '');
                        if (tmpClick.indexOf("()") != -1) {
                            var funName = tmpClick.substring(0, tmpClick.indexOf("("));
                            $(this).attr("onclick", "return proxyExecuteFun('" + funName + "');");
                        }
                    }
                }
            });
            $('body').click(function() {
                if (typeof parent.onChildPageClick != 'undefined') {
                    parent.onChildPageClick();
                }
            });
            $('form').height($(window).height() - 0).niceScroll({
                cursorcolor: '#75A801',
                horizrailenabled: false
            });
            $(window).resize(function() {
                ReSizeScrollbar();
            });
        });
    </script>
    <script type="text/javascript">
        $(function() {

            $("#tab").etmTabs({
                item: [{
                    Url: '/Modules/OA/Index.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4',
                    Selected: false,
                    Text: "首页"
                }, {
                    Url: '/Modules/OA/InfoList.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4',
                    Selected: false,
                    Text: "公告"
                }, {
                    Url: '/Modules/OA/MyFileList.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4',
                    Selected: false,
                    Text: "知识文库"
                }, {
                    Url: 'javascript:void(0);',
                    Selected: true,
                    Text: "素材库"
                }]
            });
            $("#btnDel").click(function() {
                var count = $(".selectItem:checked").size();
                if (count == 0) {
                    alert("请选择要删除的素材");
                } else if (confirm("确定要删除吗？")) {
                    var guids = "";
                    var titles = "";
                    $(".selectItem:checked").each(function() {
                        guids += "," + $(this).val();

                        titles += "、" + $(this).parents("tr:first").find(".fileNameIco").attr("title");
                    });
                    if (titles.length > 0) {
                        titles = titles.substring(1);
                    }
                    window.parent.showsending(true, '执行中，请耐心等待...');
                    $.ajaxMethod("OA_CMyFileList_Del", {
                            "Guids": guids,
                            "Titles": titles
                        },
                        function(result) {
                            window.parent.showsending(false, '');
                            if (result == "true") {
                                alert("删除成功");
                            } else {
                                alert("删除失败");
                            }
                        },
                        true, "text");
                }
            });


            $("#btnShare").click(function() {
                if ($(".selectItem:checked").size() == 0) {
                    alert("请选择要共享的文件");
                } else {
                    var guidStr = "";
                    var nameStr = "";
                    $(".selectItem:checked").each(function() {
                        guidStr += "," + $(this).val();
                        nameStr += "、" + $(this).parents("tr").eq(0).find(".fileNameIco").attr("title");
                    });
                    $.cookie("ShareGuid", guidStr);
                    $.cookie("ShareFileName", nameStr.substring(1));
                    window.parent.showDialog("共享给", "/Modules/OA/CFileShare.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4", "603px", "450px");
                }
            });
            $("#btnCancelShare").click(function() {
                if ($(".selectItem:checked").size() == 0) {
                    alert("请选择要取消共享的文件");
                } else {
                    if (confirm("只能取消创建人为当前用户及下属共享的文件")) {
                        var guidStr = "";
                        var nameStr = "";
                        $(".selectItem:checked").each(function() {
                            guidStr += "," + $(this).val();
                            nameStr += "、" + $(this).parents("tr").eq(0).find(".fileNameIco").attr("title");
                        });
                        nameStr = nameStr.substring(1);
                        if (guidStr.length > 0) {
                            window.parent.showsending(true, '执行中，请耐心等待...');
                            $.ajaxMethod("OA_CMyFileList_CancelShare", {
                                "filelist": guidStr,
                                "filename": nameStr
                            }, function(result) {
                                window.parent.showsending(false, '');
                                if (result != null && result == "true") {
                                    alert("文件成功取消共享");
                                } else if (result == "-1") {
                                    alert("传参失败");
                                } else {
                                    alert("文件取消共享操作失败");
                                }
                            }, true, "text");
                        }
                    }


                }
            });

            $("#btnUpload").click(function() {
                window.parent.showDialog("文件上传", "/Modules/OA/C_FileUpload.aspx?sc=btn&navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4", "900px", "500px");
            });

            $("#linkContent").etmLinks({
                item: [{
                    Text: "全部文件",
                    Url: "javascript:void(0);",
                    Selected: true
                }, {
                    Text: "文档",
                    Url: "javascript:void(0);"
                }, {
                    Text: "图片",
                    Url: "javascript:void(0);"
                }, {
                    Text: "音视频",
                    Url: "javascript:void(0);"
                }, {
                    Text: "其它",
                    Url: "javascript:void(0);"
                }, {
                    Text: "共享文件",
                    Url: "javascript:void(0);"
                }]
            });

            $("#linkContent a").click(function() {
                $("#tbKey").val("");
                var linkstatus = 0;
                var hiddenShare = false;
                switch ($(this).html()) {
                    case "全部文件":
                        linkstatus = 0;
                        break;
                    case "文档":
                        linkstatus = 1;
                        break;
                    case "图片":
                        linkstatus = 2;
                        break;
                    case "音视频":
                        linkstatus = 3;
                        break;
                    case "其它":
                        linkstatus = 4;
                        break;
                    case "共享文件":
                        linkstatus = 5;
                        hiddenShare = true;
                        break;
                }
                if (hiddenShare) {
                    $("#btnShare").addClass("hidden");
                    $("#btnCancelShare").removeClass("hidden");
                } else {
                    $("#btnCancelShare").addClass("hidden");
                    $("#btnShare").removeClass("hidden");
                }
                $("#tbFileType").val(linkstatus);
                RefreshGrid();
            });

            $("#tagGuids").val("");

            function getTagGuid() {
                var guidStr = "";
                $("#tags .item").each(function() {
                    //guidStr += ","+$(this).attr("guid");
                    guidStr += "," + $(this).attr("mname");
                });
                $("#tagGuids").val(guidStr);
            }

            function checkCount() {
                if ($("#tags .item").size() > 0) {
                    $("#searchContainer").addClass("borderBottom");
                    $("#tags").removeClass("hidden");
                } else {
                    $("#tags").addClass("hidden");
                    $("#searchContainer").removeClass("borderBottom");
                }
            }

            function setGridHeight() {
                if (!$("#tags").hasClass("hidden")) {
                    $(".bDiv").height($(window).height() - 150 - $("#tags").height());
                } else {
                    $(".bDiv").height($(window).height() - 150);
                }
            }
            $("#tagSelect span").click(function(e) {
                e.stopPropagation();
                if ($(this).hasClass("selected")) {
                    $(this).removeClass("selected");
                    $("#sss" + $(this).attr("id")).remove();
                } else {
                    $(this).addClass("selected");
                    $("#tags .tagContainer").append("<span mname='" + $.trim($(this).text()) + "' class='item'  id='sss" + $(this).attr("id") + "'>" + $.trim($(this).text()) + "<div>×</div></span>");
                }
                checkCount();
                $("#tagSelect").addClass("hidden");
                getTagGuid();
                RefreshGrid();

                setGridHeight();
                ReSizeFlexgridScrollbar();
            });
            $("#tags .item div").live("click", function() {
                $("#" + $(this).parent().attr("id").substring(3)).removeClass("selected");
                $(this).parent().remove();
                checkCount();
                getTagGuid();
                RefreshGrid();
                setGridHeight();
                //  $(".bDiv").height($(window).height() - tmpHeight);
                ReSizeFlexgridScrollbar();
            });
            $("#btnTag").click(function(e) {
                e.stopPropagation();
                $("#tagSelect").removeClass("hidden");
            });
            $("body").click(function() {
                $("#tagSelect").addClass("hidden");
            });
            $('#tagSelect,#uploadContainer .uploadItemList').niceScroll({
                cursorcolor: '#75A801',
                horizrailenabled: false
            });


            $("#uploadContainer .uploadItemList input,#uploadContainer .uploadItemList textarea").placeholder();

            function FileInfo(fileName, filePath, filesize, description, fileTag) {
                this.FileName = fileName;
                this.FilePath = filePath;
                this.FileSize = filesize;
                this.FileDescription = description;
                this.FileTag = fileTag;
            }

            $("#btnSubmit").click(function() {
                var canDo = true;
                if ($(".uploading").size() > 0 && !confirm("还有文件在上传中，确定要发布吗？\n这将忽略这些上传中的文件")) {
                    canDo = false;
                }
                if (canDo) {
                    var fileArray = new Array();
                    var $file = $("#uploadContainer .uploadItemList .uploadItem");
                    if ($file.size() > 0) {
                        $file.each(function() {
                            if (!$(this).hasClass(".uploading")) { //上传中的忽略不计
                                fileArray.push(new FileInfo($(this).attr("filename"), $(this).attr("fileurl"), $(this).attr("filesize"), $(this).find(".fileDescription").val(), $(this).find(".fileTag").val()));
                            }
                        });
                    }
                    if (fileArray.length > 0) {
                        window.parent.showsending(true, '执行中，请耐心等待...');
                        $.ajaxMethod("OA_CMyFileList_Add", {
                                "FileList": JSON2.stringify(fileArray)
                            },
                            function(result) {
                                window.parent.showsending(false, '');
                                if (result == "-1") {
                                    alert("会话过期");
                                } else if (result == "-2") {
                                    alert("提交失败(-2)");
                                } else if (result == "-3") {
                                    alert("提交失败(-3)");
                                } else if (result == "1") {

                                    $("#uploadContainer .uploadItemList").html("");
                                    $("#uploadContainer").addClass("hidden");

                                    alert("提交成功");
                                } else {
                                    alert("提交失败");
                                }
                            },
                            true, "text");
                    } else {
                        alert("当前没有已上传完成的文件");
                    }
                }


            });


            function resizeUploadContainer() {
                $('#uploadContainer .uploadItemList').getNiceScroll().onResize();
            }

            function getId(file) {
                return "sa" + file.id;
            }

            function uploadError(file, error) {
                var $file = $('#sa' + file.id);
                $file.find(".warning").removeClass("hidden").html(error);
                $file.find(".percent").addClass("hidden");
                setTimeout(function() {
                    $('#' + getId(file)).remove();
                    if ($("#uploadContainer .uploadItemList .uploadItem").size() < 1) {
                        $("#uploadContainer").addClass("hidden");
                    }
                    resizeUploadContainer();
                }, 2000);
            }



            $("#btnUpload1").uploadify({
                'height': '20',
                'buttonText': '',
                'fileTypeDesc': '文件',
                'fileTypeExts': '*.doc; *.xls; *.ppt; *.rtf; *.pdf; *.docx; *.pptx; *.xlsx; *.jpg; *.jpeg; *.png; *.gif; *.bmp; *.tiff; *.tif; *.zip; *.rar; *.7z; *.mkv; *.mp4; *.rm; *.rmvb; *.mp3; *.wav; *.wma; ',
                'swf': '/Scripts/uploadify/uploadify.swf',
                'uploader': '/ashx/FileUpload.ashx?action=oa_file',
                'width': '90',
                'multi': true,
                'auto': true,
                'onUploadProgress': function(file, fileBytesLoaded, fileTotalBytes) {
                    var percentage = Math.round(fileBytesLoaded / fileTotalBytes * 100);
                    $('#' + getId(file) + " .percent").html(percentage + "%");
                },
                'onUploadError': function(file, errorCode, errorMsg, errorString) {
                    uploadError(file, errorMsg + errorString);
                },
                'onUploadStart': function(file) {
                    $("#uploadContainer").removeClass("hidden");
                    $("#uploadContainer .uploadItemList").append("<div id='" + getId(file) + "' filesize='" + file.size + "' filename='" + file.name +
                        "' class='uploadItem borderBottom uploading'><div class='uploadInfo'><span class='fileName' >" + file.name +
                        "</span><span class='percent'>0%</span><div class='warning hidden'>上传失败，</div><div class='clear'></div></div><input type='text' class='fileTag int' placeholder='请给素材设置标签，以空格间隔多个标签'/><input type='text' class='fileDescription int' placeholder='请给素材添加描述'/></div>"
                    );
                    resizeUploadContainer();
                },
                'onSelect': function(e, queueId, fileObj) {},
                'onQueueComplete': function(queueData) {
                    // alert(queueData.uploadsSuccessful + ' files were successfully uploaded.');//没有 只是队列上传完成
                    // isAllUploadComplete = true;
                },
                'onUploadSuccess': function(file, data, response) {
                    if (data == "-1") { //不支持的格式
                        uploadError(file, "不支持的格式");

                    } else if (data == "-2") { //此文件跟文件后缀不相符
                        uploadError(file, "文件跟后缀不相符");
                    } else if (data != null && data.indexOf("~") != -1) {
                        $("#" + getId(file)).attr("fileurl", data).removeClass("uploading");
                    }
                }
            });


            $("#btnViewFileShare").live("click", function() {
                window.parent.showDialog("共享给谁", "/Modules/OA/CFileShareDetail.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4&guid=" + $(this).parent().attr("guid"), "500px", "350px");
            });

            $("#btnSaveAs").live("click", function() {
                window.parent.showsending(true, '执行中，请耐心等待...');
                $.ajaxMethod("OA_CMyFileList_ShareFileSaveAs", {
                        "Guid": $(this).parent().attr("guid")
                    },
                    function(result) {
                        window.parent.showsending(false, '');
                        if (result == "-1") {
                            alert("传参错误");
                        } else if (result == "-4") {
                            alert("不能转出自己共享的素材");
                        }
                        //                        else if (result == "-5") {
                        //                            alert("当前共享的素材已保存到我的素材库");
                        //                        }
                        else if (result == "-2") {
                            alert("当前共享的素材已被删除");
                        } else if (result == "1") {
                            alert("共享的素材已保存到我的素材库");
                        } else {
                            alert("保存失败");
                        }
                    },
                    false, "text");

            });
            //btnSaveAs

            $(".btnEditSave").live("click", function(e) {
                e.stopPropagation();
                var $parent = $(this).parent();
                var str = $.trim($parent.find(".int").val());
                if (str.length == 0) {
                    alert("请输入内容");
                    return;
                }
                //                switch ($(this).attr("s")) {
                //                case "1": //名称
                //                    break;
                //                case "2": //描述
                //                    break;
                //                case "3": //标签
                //                    break;
                //                }
                window.parent.showsending(true, '执行中，请耐心等待...');
                $.ajaxMethod("OA_CMyFileList_FileInfoEdit", {
                        "Guid": $(this).attr("guid"),
                        "EditType": $(this).attr("s"),
                        "Content": str
                    },
                    function(result) {
                        window.parent.showsending(false, '');
                        if (result == "-1") {
                            alert("传参错误");
                        } else if (result == "-3") {
                            alert("请输入内容");
                        } else if (result == "-2") {
                            alert("当前编辑的素材已被删除");
                        } else if (result == "1") {
                            alert("编辑成功");
                        } else {
                            alert("编辑失败");
                        }
                    },
                    true, "text");
            });

            $(".btnEditCancel").live("click", function() {
                var $parent = $(this).parent();
                var str = $parent.attr("title");
                var lenght = parseInt($(this).attr("l"));
                if (str == undefined || str == null) {
                    str = "";
                } else if (str.length > lenght) {
                    str = str.substring(0, lenght) + "...";
                }
                $parent.prepend("<span class='itemText'>" + str + "</span>");
                $parent.find(".int").addClass("hidden").val("");
                $parent.find(".btnEditSave").addClass("hidden");
                $parent.find(".btnEditCancel").addClass("hidden");
            });

            $(".btnEditItem").live("click", function(e) {
                e.stopPropagation();
                var $fileName = null;
                var width = 150;
                switch ($(this).attr("id")) {
                    case "btnEditName":
                        $fileName = $(this).parents("tr:first").find(".fileNameIco");
                        width = $fileName.parent().width() - 30 - 30 - 30;
                        break;
                    case "btnEditDescription":
                        $fileName = $(this).parents("tr:first").find(".itemfileDescription");
                        width = $fileName.parent().width() - 30 - 30;
                        break;
                    case "btnEditTag":
                        $fileName = $(this).parents("tr:first").find(".itemfileTag");
                        width = $fileName.parent().width() - 30 - 30;
                        break;
                }
                if ($fileName != null) {
                    $fileName.find(".itemText").remove();
                    $fileName.find(".int").width(width).removeClass("hidden");
                    $fileName.find(".btnEditSave").attr("guid", $("#btnList").attr("guid")).removeClass("hidden");
                    $fileName.find(".btnEditCancel").removeClass("hidden");
                }
                $("#btnList").remove();
                //listItem
            });

            var timer = null;

            function setTimer() {
                timer = setTimeout(function() {
                    $("#btnList").remove();
                }, 200);
            }
            $(".bDiv tr").live({
                mouseenter: function(e) {
                    $("#btnList").remove();
                    if (timer != null) {
                        try {
                            clearTimeout(timer);
                            timer = null;
                        } catch (e) {

                        }
                    }
                    var $fileNameIco = $(this).find(".fileNameIco");
                    if ($("#btnShare").hasClass("hidden")) { //共享文件

                        var str = "";
                        if ('36bdee20-6016-4f4e-a290-582c1143a5b7'.toLowerCase() != $fileNameIco.attr("CreatorGuid").toLowerCase()) {
                            str = "<a href='javascript:void(0);' id='btnSaveAs'>保存到我的素材库</a>";
                        }
                        $fileNameIco.parent().parent().append("<div id='btnList' guid='" + $(this).find(".selectItem").val() + "' ><a href='javascript:void(0);' id='btnViewFileShare'>查看共享信息</a>" + str + "</div>");
                    } else {
                        var editing = false;
                        $(this).find(".int").each(function() {
                            if (!$(this).hasClass("hidden")) {
                                editing = true;
                            }
                        });
                        if (editing) {
                            return;
                        }
                        $fileNameIco.parent().parent().append("<div id='btnList' guid='" + $(this).find(".selectItem").val() +
                            "' ><a href='javascript:void(0);' id='btnEditName' class='btnEditItem'>编辑名称</a><a href='javascript:void(0);' id='btnEditDescription' class='btnEditItem'>编辑描述</a><a href='javascript:void(0);' id='btnEditTag' class='btnEditItem'>编辑标签</a><a href='" +
                            $fileNameIco.attr("fileurl") + "' target='_blank'>下载</a></div>");
                    }
                    //setTimer();
                },
                mousemove: function(e) {
                    e.stopPropagation();
                },
                mouseleave: function() {
                    setTimer();
                }
            });

        });
    </script>
    <style type="text/css">
        .bDiv .hidden {
            display: none !important;
        }

        .btnEditSave,
        .btnEditCancel {
            border: 1px solid #DAD8D4;
            display: inline-block;
            height: 21px;
            width: 21px;
            line-height: 21px;
            position: absolute;
            text-align: center;
            margin-left: 2px;
            background: white;
        }

        .btnEditCancel {
            margin-left: 30px;
        }

        .listItem {
            position: relative;
            display: block;
        }

        .tabs {
            margin-bottom: 1px;
        }

        .fileNameIco {
            padding-left: 32px !important;
            display: block;
            height: 21px;
            line-height: 21px;
        }

        #tags {
            padding-left: 20px;
            width: 100%;
        }

        #tags .item {
            position: relative;
            border: 1px solid #DAD8D4;
            padding-right: 30px;
            display: inline-block;
            height: 25px;
            line-height: 25px;
            padding-left: 10px;
            margin-top: 5px;
            margin-bottom: 5px;
            margin-right: 10px;
            background: white;
        }

        #tags .item div {
            position: absolute;
            top: -2px;
            right: 0px;
            font-size: 18px;
            width: 20px;
        }

        #tagSelect {
            position: fixed;
            top: 85px;
            left: 200px;
            width: 400px;
            height: 250px;
            z-index: 3;
            border: 1px solid #DAD8D4;
            background: white;
        }

        #tagSelect span {
            height: 25px;
            line-height: 25px;
            padding-left: 10px;
            padding-right: 10px;
            border: 1px solid #DAD8D4;
            margin-left: 10px;
            margin-top: 10px;
            display: inline-block;
        }

        #tagSelect span:hover,
        #tags .item div:hover {
            cursor: pointer;
        }

        #uploadContainer {
            width: 400px;
            height: 250px;
            border: 1px solid #DAD8D4;
            background: white;
            position: fixed;
            bottom: 0px;
            right: 0px;
            z-index: 9999;
        }

        #uploadContainer .uploadItemList {
            height: 210px;
            width: 100%;
        }

        #uploadContainer .uploadItemList .uploadItem {
            margin-top: 10px;
        }

        #uploadContainer .uploadItemList .uploadItem .uploadInfo {
            position: relative;
            margin-top: 5px;
            width: 380px;
        }

        #uploadContainer .uploadItemList .uploadItem .uploadInfo .warning {
            position: absolute;
            top: 0px;
            right: 0px;
            color: red;
        }

        #uploadContainer .uploadItemList .uploadItem .uploadInfo .percent {
            float: right;
        }

        #uploadContainer .uploadItemList .uploadItem .uploadInfo,
        #uploadContainer .uploadItemList .uploadItem .fileTag,
        #uploadContainer .uploadItemList .uploadItem .fileDescription {
            margin-left: 10px;
        }

        #uploadContainer .uploadItemList .uploadItem .fileDescription {
            margin-bottom: 10px;
        }

        #uploadContainer .fileTag,
        #uploadContainer .fileDescription {
            display: block;
            width: 370px;
            padding-left: 10px;
            margin-top: 10px;
        }

        #uploadContainer #btnSubmit {
            margin: 0px auto;
            margin-top: 5px;
        }

        .bDiv td {
            position: relative;
        }

        #btnList {
            position: absolute;
            top: 0px;
            right: 0px;
            height: 32px;
            border-left: 1px solid #DAD8D4;
            background: white;
            padding-left: 10px;
            z-index: 99;
            padding-top: 0px !important;
        }

        #btnList a {
            display: inline-block;
            margin-right: 10px;
            height: 32px;
            line-height: 32px;
        }

        #btnUpload1Container {
            -ms-opacity: 0;
            opacity: 0;
            filter: alpha(opacity=0);
        }

        #btnUpload1Container #btnUpload1-button {
            background: transparent;
        }

        @media screen and (-webkit-min-device-pixel-ratio:0) {
            #tags .item div {
                top: 0px;
                font-size: 25px;
            }
            .int {
                height: 19px !important;
            }
            #btnUpload1Container {
                right: 195px !important;
            }
        }

        @media all and (-ms-high-contrast:none) {
            #tags .item div {
                top: 0px;
                font-size: 25px;
            }
            .int {
                height: 19px !important;
            }
        }

        @media screen\0 {
            #tags .item div {
                top: 0px;
                font-size: 25px;
            }
            .int {
                height: 19px !important;
            }
            #btnUpload1Container {
                right: 200px !important;
            }
        }
    </style>
</head>

<body>
    <form method="post" action="CMyFileList.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4" id="form1">
        <div class="aspNetHidden">
            <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTg3NjM4NDAwNWRkTn8pyISDzq2YbRvouN1G8E4t5Jjsz7vmZbgW6SZ/les=" />
        </div>

        <div class="aspNetHidden">

            <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="D26DF95E" />
            <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAALMIzStPU7sdZo/UxGhuKyDABHAA+BIO9P8laS8B8ll4vux+LBqbITcdiwEhHuJRGOmCwGUANdy53lyS3rkf/y2" />
        </div>
        <div id="uploadContainer" class="hidden">
            <div class="uploadItemList">
            </div>
            <div style="text-align: center;">
                <input type="button" class="button" value="提 交" id="btnSubmit" />
            </div>
        </div>

        <input type="text" class="hidden" name="tbFileType" id="tbFileType" />

        <div style="padding-left: 20px; width: 100%; height: 40px; line-height: 40px; position: relative;" id="searchContainer" class="">
            文件操作：
            <input type="text" id="tbKey" name="tbKey" class="int" style="width: 200px;" />&nbsp;&nbsp;
            <input type="button" style="margin-left:20px;" class="button" value="搜&nbsp;&nbsp;&nbsp;&nbsp;索" id="btnSearch" />&nbsp;&nbsp;
            <input name="btnTag" type="button" id="btnTag" class="button" value="标    签" />
            <div style="position: absolute; top: 0px; right: 25px;" id="btnOps">
                <input type="button" class="button" value="文件上传" id="btnUpload" />&nbsp;&nbsp;
                <input type="button" class="button" value="共&nbsp;&nbsp;&nbsp;&nbsp;享" id="btnShare" />
                <input type="button" class="button hidden" value="取消共享" id="btnCancelShare" />&nbsp;&nbsp;
                <input type="button" class="button" value="删&nbsp;&nbsp;&nbsp;&nbsp;除" id="btnDel" />
            </div>

            <div id="btnUpload1Container" style="position: absolute; top: 0px; right: 210px; opacity: 0; -ms-opacity: 0; filter: alpha(opacity=0);">
                <input type="button" class="button" value="文件上传" id="btnUpload1" />
            </div>
        </div>

        <div id="tagSelect" class="hidden">
            <span id='ss0'>测试</span>
        </div>

        <div id="tags" class="hidden">
            <table cellpadding="0" cellspacing="0">
                <tr>
                    <td style="width: 66px;">文件标签：
                        <input id="tagGuids" name="tagGuids" class="hidden" type="text" />
                    </td>
                    <td class="tagContainer">










                    </td>
                </tr>
            </table>


        </div>
        <div id="linkContent"></div>
        <table id='Test' style='display:none;'></table>
        <input type='text' style='display:none;' id='etmparams' name='etmparams' value='[{"IsCanHide":false,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"","Name":"FileInfoGuid","Width":35,"Sortable":false,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"Center","Checkbox":true,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":"FileNameWithIco","Display":"名称","Name":"FileName,IconForList,CreatorGuid,FilePath,IsImg","Width":300,"Sortable":false,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"left","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"描述","Name":"FileDescription","Width":300,"Sortable":true,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"left","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"文件大小(byte)","Name":"FileSize","Width":140,"Sortable":true,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"Center","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"创建人","Name":"CreatorName","Width":140,"Sortable":true,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"Center","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":"yyyy-MM-dd HH:mm:ss","ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"创建时间","Name":"CreateTime","Width":140,"Sortable":true,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"Center","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false},{"IsCanHide":true,"FormatString":null,"ColumnType":"String","PageColumnGuid":"00000000-0000-0000-0000-000000000000","PageName":null,"SortId":0,"IsSetValueEqualName":false,"VirtualColumn":null,"Display":"标签","Name":"FileTag","Width":300,"Sortable":false,"ColumnHeader_BindId":null,"ColumnHeader_IsBindDropDownList":false,"Align":"left","Checkbox":false,"IsLink":false,"LinkStrForamtBindColumn":null,"LinkStrForamt":null,"LinkClass":"","OperationButtons":"","SubStringLength":0,"BindAttrs":null,"IsJsAddColumn":false}]'
        />
        <input type='text' style='display:none;' id='etmUrlparams' name='etmUrlparams' value='[{"Key":"navId","Value":"f2e56366-9a0b-483c-8430-ab41e60bc7a4"}]' />
        <input type='text' style='display:none;' id='etmPageUrl' name='etmPageUrl' value='http://vip.yj.etmcn.com/Modules/OA/CMyFileList.aspx?navId=f2e56366-9a0b-483c-8430-ab41e60bc7a4' />
        <input type='text' style='display:none;' id='pagename' name='pagename' value='OA_CMyFileList' />
        <input type='text' style='display:none;' id='pageamethod' name='pageamethod' value='OA_CMyFileListOA_CMyFileList' />
        <script type='text/javascript'>
            var etmFormId = 'form1';

            function fixIE9() {
                if ($.browser.msie && $.browser.version == 9) {
                    $('#form1 select').each(function() {
                        var name = $(this).attr('name');
                        if (name != undefined && name.length > 0) {
                            var value = $(this).val();
                            if (value == null) {
                                value = $(this).find('option:first').attr('value');
                                $(this).val(value);
                            }
                        }
                    });
                }
            }

            function RefreshGrid() {
                $('#Test').flexOptions().flexReload();
            };

            function addFormData() {
                fixIE9();
                var dt = $('#form1').serializeArray();
                $('#Test').flexOptions({
                    params: dt
                });
                return true;
            }
            $(function() {
                $('#btnSearch').click(function() {
                    $('#Test').flexOptions({
                        newp: 1
                    }).flexReload();
                    return false;
                });
            });
            $('#Test').flexigrid({
                url: 'http://vip.yj.etmcn.com/Ajax/OA_CMyFileList',
                sortname: 'CreateTime',
                sortorder: 'desc',
                usepager: true,
                useRp: true,
                rpOptions: [20, 30, 50, 100, 200],
                rp: 30,
                colModel: [{
                    display: '',
                    name: 'FileInfoGuid',
                    etmname: 'FileInfoGuid',
                    width: 35,
                    sortable: false,
                    align: 'Center',
                    checkbox: true,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: false,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '名称',
                    name: 'FileName,IconForList,CreatorGuid,FilePath,IsImg',
                    etmname: 'FileNameWithIco',
                    width: 300,
                    sortable: false,
                    align: 'left',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '描述',
                    name: 'FileDescription',
                    etmname: 'FileDescription',
                    width: 300,
                    sortable: true,
                    align: 'left',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '文件大小(byte)',
                    name: 'FileSize',
                    etmname: 'FileSize',
                    width: 140,
                    sortable: true,
                    align: 'Center',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '创建人',
                    name: 'CreatorName',
                    etmname: 'CreatorName',
                    width: 140,
                    sortable: true,
                    align: 'Center',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '创建时间',
                    name: 'CreateTime',
                    etmname: 'CreateTime',
                    width: 140,
                    sortable: true,
                    align: 'Center',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: 'yyyy-MM-dd HH:mm:ss',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }, {
                    display: '标签',
                    name: 'FileTag',
                    etmname: 'FileTag',
                    width: 300,
                    sortable: false,
                    align: 'left',
                    checkbox: false,
                    IsLink: false,
                    LinkClass: '',
                    OperationButtons: '',
                    SubStringLength: 0,
                    hide: false,
                    BindId: '',
                    IsForDDL: false,
                    IsCanHide: true,
                    FormatString: '',
                    ColumnType: 'String',
                    IsJsAddColumn: false
                }],
                width: $(window).width(),
                height: $(window).height() - 210 + 60,
                onSubmit: addFormData
            });
        </script>








    </form>
</body>

</html>
